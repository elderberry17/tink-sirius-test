# Описание решения

### 1. Запуск

В качестве обертки для модели я написал телеграм-бота (@tins_sirius_sns_bot) и создал простое web-приложение с помощью фреймворка ```streamlit```

***0) Для начала:***

    ```git clone https://github.com/elderberry17/tink-sirius-test.git```
    
    ```cd tink-sirius-test```

***1) Запуск бота:***
   
   ```docker build -t tink_sns_bot -f Dockerfile.bot .```
   
   ```docker run tink_sns_bot```

***2) Запуск веб-приложения:***

   ```docker build -t tink_sns_web -f Dockerfile.web .```
   
   ```docker run tink_sns_web```

### 2. Эксперименты
   
В процессе дообучения я использовал данный google colab:
https://clck.ru/35XhGD

Я пробовал дообучать модель на разных данных: переписках с друзьями, учебных чатах, чатах профессиональных коммьюнити.
В итоге я остановился на 3-х вариантах, в раз захостил несколько версий бота с помощью сервиса ```beget``` (https://beget.com/ru) и устроил тестирование с помощью друзей.
Результаты тестирования приведены в таблице ниже:
https://clck.ru/35Xh72

Я постарался выбрать самого достойного бота также учитывая статистику опроса подписчиков в своем небольшом телеграм-канале (сейчас он закрыт, так что данные дать не могу), мнение людей в среднем совпадало с точечным мнением трех тестировщиков)

Победила модель, обученная на данных известного чата о стажировках (https://t.me/sns_internships). В среднем она выдает наиболее осмысленные и интеллектуальные беседы :)
В итоге в конфигах я оставил токен и ссылки на нужного бота и нужную модель соответственно.

### 3. Благодарности

Спасибо Тинькофф образованию за возможность увлекательно провести время, работая над интересной задачей, узнать новое и отработать старое.
Хорошего дня проверящим!

   

# sirius-test
Кейс по NLP для смены по машинному обучению от Тинькофф в Университете "Сириус".
В рамках задания необходимо обучить свою диалоговую языковую модель и сделать телеграм бота для взаимодействия с ней.
Что нужно сделать:
1) Скачать диалоговые данные из Telegram. Можно взять любой открытый чат
2) Затюнить открытую модель с хаггинфейса (в качестве базовой модели рекомендуем взять https://huggingface.co/tinkoff-ai/ruDialoGPT-medium)
3) Для сёрвинга модели напишите телеграм бота
4) Будет плюсом, если вы обернёте телеграм бота в докер. Дополнительным плюсом будет, если вы также сделаете отдельный сервис для модели и будуте сёрвить её в отдельном докере

В качестве решения задания нужно прислать публичный репозиторий, в котором должен быть код решения задачи и readme с описанием решения. Для обучения модели рекомендуем использовать google colab.

## Вспомогательные инструкции

### Как получить сырые данные из телеграма

![pic](data.png)

В настройках выгрузки нужно выбрать формат json и убрать галочки со всех медиа файлов. Так как данные могут скачиваться долго, в репозитории лежит пример выгруженных данных.

### Как распарсить данные

`python prepare_messages.py --tg-history-path 'chata_export.json' --output-path 'data.csv'`
